<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>旋转吧大喵 - 使用说明</title>
    <style>
        :root {
            --primary-color: #ff9f4f;
            --text-color: #333;
            --bg-color: #fff;
            --border-color: #eee;
            --hover-color: #fff3e6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft YaHei", "微软雅黑", sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background: var(--bg-color);
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            border-bottom: 2px solid var(--border-color);
        }

        .header h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        h2 {
            color: var(--primary-color);
            margin: 30px 0 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        h3 {
            color: #444;
            margin: 20px 0 10px;
        }

        p {
            margin: 10px 0;
        }

        ul, ol {
            margin: 10px 0 10px 20px;
        }

        li {
            margin: 5px 0;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .feature-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .feature-item h3 {
            color: var(--primary-color);
            margin-top: 0;
        }

        .mode-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }

        .mode-table th {
            background: #f8f9fa;
            padding: 12px;
            text-align: center;
            border: 1px solid var(--border-color);
            font-weight: bold;
        }

        .mode-table td {
            padding: 20px;
            border: 1px solid var(--border-color);
            vertical-align: top;
        }

        .mode-table h5 {
            color: var(--primary-color);
            margin: 15px 0 10px;
            font-size: 1.1em;
        }

        .mode-table ul, .mode-table ol {
            margin: 10px 0 10px 20px;
        }

        .mode-table li {
            margin: 5px 0;
        }

        .mode-table td:first-child h5:first-child {
            margin-top: 0;
        }

        .download-links {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .download-links a {
            color: var(--primary-color);
            text-decoration: none;
        }

        .download-links a:hover {
            text-decoration: underline;
        }

        .note {
            background: #fff3e6;
            padding: 15px;
            border-left: 4px solid var(--primary-color);
            margin: 15px 0;
        }

        code {
            background: #f8f9fa;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: Consolas, monospace;
        }

        .steps {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .steps ol {
            margin-left: 20px;
        }

        .steps li {
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            body {
                padding: 15px;
            }

            .feature-grid {
                grid-template-columns: 1fr;
            }
        }

        .danger {
            background-color: #fef0f0;
            border: 1px solid #fde2e2;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }
        .danger strong {
            color: #f56c6c;
        }
        .hotkey-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        .hotkey-table th, .hotkey-table td {
            border: 1px solid #ddd;
            padding: 0.5rem;
            text-align: left;
        }
        .hotkey-table th {
            background-color: #f8f9fa;
        }
        code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: monospace;
        }

        .doc-link {
            text-align: center;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        .doc-link a {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.8rem 1.5rem;
            background: var(--primary-color);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(255, 159, 79, 0.2);
        }
        .doc-link a:hover {
            background: var(--hover-color);
            color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 159, 79, 0.3);
        }
        .doc-link .icon {
            font-size: 1.2em;
        }
        .doc-link .arrow {
            font-size: 1.2em;
            transition: transform 0.3s ease;
        }
        .doc-link a:hover .arrow {
            transform: translateX(4px);
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>🎮 旋转吧大喵</h1>
        <p>一个为《无限暖暖》提升摄影体验的窗口调整工具</p>
    </div>

    <div class="doc-link">
        <a href="https://chaniok.github.io/SpinningMomo/" target="_blank">
            <span class="icon">📖</span>
            <span class="text">查看完整使用文档</span>
            <span class="arrow">→</span>
        </a>
    </div>

    <div class="feature-grid">
        <div class="feature-item">
            <h3>🎮 竖拍支持</h3>
            <p>完美支持游戏竖拍UI，留影沙漏和大喵相册</p>
        </div>
        <div class="feature-item">
            <h3>📸 超高分辨率</h3>
            <p>支持突破游戏和设备分辨率的照片输出</p>
        </div>
        <div class="feature-item">
            <h3>📐 灵活调整</h3>
            <p>多种预设，自定义比例和分辨率</p>
        </div>
        <div class="feature-item">
            <h3>⌨️ 快捷键支持</h3>
            <p>可自定义热键(默认Ctrl+Alt+R)</p>
        </div>
        <div class="feature-item">
            <h3>⚙️ 浮动窗口</h3>
            <p>可选的浮动菜单，便捷调整窗口</p>
        </div>
        <div class="feature-item">
            <h3>🚀 轻量运行</h3>
            <p>占用极低，性能优先</p>
        </div>
    </div>

    <h2>📥 下载地址</h2>
    <div class="download-links">
        <p>• GitHub Release：<a href="https://github.com/ChanIok/SpinningMomo/releases/latest" target="_blank">点击下载最新版本</a></p>
        <p>• 蓝奏云：<a href="https://wwf.lanzoul.com/b0sxagp0d" target="_blank">点击下载</a>（密码：momo）</p>
        <p>• 百度网盘：<a href="https://pan.baidu.com/s/1UL9EJa2ogSZ4DcnGa2XcRQ?pwd=momo" target="_blank">点击下载</a>（提取码：momo）</p>
    </div>

    <h2>🚀 使用说明</h2>

    <h3>1️⃣ 启动程序</h3>

    <div class="danger">
        <strong>重要</strong>
        <p>必须以<strong>管理员身份</strong>运行程序！</p>
    </div>

    <h4>两种授权方式：</h4>
    <ul>
        <li><strong>临时授权</strong>：右键程序 → 选择"以管理员身份运行"</li>
        <li><strong>永久授权</strong>：右键程序 → 属性 → 兼容性 → 勾选"以管理员身份运行此程序" → 应用</li>
    </ul>

    <h4>首次运行安全提示：</h4>
    <div class="warning" style="background-color: #fdf6ec; border: 1px solid #faecd8; padding: 1rem; border-radius: 4px; margin-bottom: 15px;">
        <p>首次运行时，如遇"Windows已保护您的电脑"(SmartScreen)，点击<strong>更多信息</strong>→<strong>仍要运行</strong>；遇"用户账户控制"(UAC)，请点击<strong>是</strong>。</p>
    </div>
    
    <h4>启动后：</h4>
    <ul>
        <li>系统托盘会显示程序图标</li>
        <li>默认显示浮动窗口，可直接调整窗口</li>
    </ul>

    <h3>2️⃣ 快捷键</h3>

    <table class="hotkey-table">
        <tr>
            <th>功能</th>
            <th>快捷键</th>
            <th>说明</th>
        </tr>
        <tr>
            <td>显示/隐藏浮窗</td>
            <td><code>Ctrl + Alt + R</code></td>
            <td>默认快捷键，可在托盘菜单中修改</td>
        </tr>
    </table>

    <h3>3️⃣ 拍照模式</h3>

    <table class="mode-table">
        <tr>
            <th>🌟 窗口分辨率模式（推荐）</th>
            <th>📷 标准模式</th>
        </tr>
        <tr>
            <td>
                <h5>游戏设置：</h5>
                <ul>
                    <li>显示模式：<strong>全屏窗口模式</strong>或 窗口模式</li>
                    <li>拍照-照片画质：<strong>窗口分辨率</strong></li>
                </ul>
                <h5>使用步骤：</h5>
                <ol>
                    <li>使用程序的比例选项调整构图</li>
                    <li>选择需要的分辨率预设（4K~12K）</li>
                    <li>画面会溢出屏幕，此时按空格拍照</li>
                    <li>拍摄完成后点击重置窗口</li>
                </ol>
                <h5>优势特点：</h5>
                <ul>
                    <li>✨ 支持超高分辨率（最高12K+）</li>
                    <li>✨ 可自由调整比例和分辨率</li>
                </ul>
            </td>
            <td>
                <h5>游戏设置：</h5>
                <ul>
                    <li>显示模式：<strong>窗口模式</strong> 或 全屏窗口模式（比例受限）</li>
                    <li>拍照-照片画质：<strong>4K</strong></li>
                </ul>
                <h5>特点说明：</h5>
                <ul>
                    <li>✅ 操作便捷，适合日常拍摄和预览</li>
                    <li>✅ 始终保持流畅运行，无需额外性能开销</li>
                    <li>❗ 只能调整比例，分辨率基于游戏设置的4k</li>
                    <li>❗ 全屏窗口模式下输出受限于显示器原始比例</li>
                </ul>
            </td>
        </tr>
    </table>

    <h3>4️⃣ 可选功能</h3>

    <table class="mode-table">
        <tr>
            <th>🔍 预览窗</th>
            <th>🖼️ 叠加层</th>
        </tr>
        <tr>
            <td>
                <h5>功能说明：</h5>
                <ul>
                    <li>类似 Photoshop 的导航器功能</li>
                    <li>在窗口溢出屏幕时提供实时预览</li>
                </ul>
                <h5>使用场景：</h5>
                <ul>
                    <li>✨ 高分辨率拍摄时查看放大后的细节</li>
                    <li>✨ 窗口溢出屏幕时辅助定位</li>
                </ul>
            </td>
            <td>
                <h5>功能说明：</h5>
                <ul>
                    <li>类似 Magpie 的反向缩小版</li>
                    <li>将目标窗口捕获并渲染到全屏叠加层上</li>
                    <li>⚠️ 比预览窗额外消耗一些CPU资源</li>
                </ul>
                <h5>使用场景：</h5>
                <ul>
                    <li>✨ 提供无感知放大的操作体验</li>
                    <li>✨ 在超大分辨率下依然保持良好交互</li>
                </ul>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="warning" style="text-align: center; background-color: #fdf6ec; border: 1px solid #faecd8; padding: 1rem; border-radius: 4px;">
                    <strong style="color: #e6a23c;">💡 性能说明</strong>
                    <p>得益于高效的捕获方式，这两种功能几乎不会造成明显的性能下降。<br/>
                    但如果你选择的高分辨率已经让电脑卡成PPT了，建议暂时不要开启这些功能。</p>
                </div>
            </td>
        </tr>
    </table>

    <style>
    .mode-table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        background: white;
    }
    .mode-table th {
        background: #f8f9fa;
        padding: 12px;
        text-align: center;
        border: 1px solid var(--border-color);
        font-weight: bold;
    }
    .mode-table td {
        padding: 20px;
        border: 1px solid var(--border-color);
        vertical-align: top;
    }
    .mode-table h5 {
        color: var(--primary-color);
        margin: 15px 0 10px;
        font-size: 1.1em;
    }
    .mode-table ul, .mode-table ol {
        margin: 10px 0 10px 20px;
    }
    .mode-table li {
        margin: 5px 0;
    }
    .mode-table td:first-child h5:first-child {
        margin-top: 0;
    }
    </style>

    <h2>📏 分辨率说明</h2>
    <div class="note">
        <h3>输出分辨率计算过程：</h3>
        <ol>
            <li>根据选择的分辨率预设（如 4K、8K）确定总像素数</li>
            <li>根据选择的比例计算最终的宽高</li>
        </ol>
        <p>例如：选择 8K（约 3320 万像素）和 9:16 比例</p>
        <ul>
            <li>计算得到 4320x7680 的输出分辨率（4320x7680=3320万像素）</li>
            <li>保证总像素数与预设值相近</li>
        </ul>
    </div>

    <h2>🎯 托盘功能</h2>
    <p>右键或左键点击托盘图标可以：</p>
    <ul>
        <li>🎯 选择目标窗口：从子菜单中选择要调整的窗口</li>
        <li>📐 窗口比例：选择预设比例或自定义比例</li>
        <li>📏 分辨率：选择预设分辨率或自定义分辨率</li>
        <li>📸 截图：保存无损截图到程序目录下的ScreenShot文件夹中，主要用于调试和不支持截图的游戏（正常不需要使用）</li>
        <li>📂 打开相册：打开游戏相册目录，用于查看和打开游戏截图</li>
        <li>⬛ 黑边模式：为非屏幕比例窗口添加全屏黑色背景，提升沉浸感并解决叠加层下任务栏闪烁问题</li>
        <li>🔲 切换窗口边框：切换游戏窗口边框显示，可以移除窗口标题栏和边框</li>
        <li>🔽 隐藏任务栏：隐藏任务栏，用于防止任务栏遮挡</li>
        <li>⬇️ 调整时置底任务栏：调整窗口时将任务栏置底，用于防止任务栏遮挡</li>
        <li>🔍 预览窗：类似 Photoshop 的导航器，在窗口溢出屏幕时提供实时预览和导航功能（可选功能）
            <ul>
                <li>支持拖拽窗口顶部区域移动位置，滚轮缩放窗口大小</li>
            </ul>
        </li>
        <li>🖼️ 叠加层：将目标窗口渲染到全屏叠加层上，提供无感知放大的操作体验（可选功能）</li>
        <li>⌨️ 修改热键：设置新的快捷键组合</li>
        <li>📱 浮窗模式：默认开启，可以在此开启/关闭浮动菜单。关闭后可使用热键（默认 Ctrl+Alt+R）打开调整菜单</li>
        <li>🌐 语言：切换语言</li>
        <li>⚙️ 打开配置文件：自定义比例和分辨率</li>
        <li>❌ 退出：关闭程序</li>
    </ul>

    <h2>⚙️ 自定义设置</h2>
    <div class="steps">
        <ol>
            <li>右键托盘图标，选择"打开配置文件"</li>
            <li>在配置文件中，您可以自定义以下内容：
                <ul>
                    <li><strong>自定义比例：</strong> 在 <code>[Menu]</code> 节的 <code>AspectRatioItems</code> 项中添加或修改，格式为逗号分隔的列表，例如：<code>32:9,21:9,16:9,3:2,1:1,2:3,9:16,16:10</code></li>
                    <li><strong>自定义分辨率：</strong> 在 <code>[Menu]</code> 节的 <code>ResolutionItems</code> 项中添加或修改，格式为逗号分隔的列表，例如：<code>Default,4K,6K,8K,12K,5120x2880</code></li>
                </ul>
            </li>
            <li>分辨率格式说明：
                <ul>
                    <li>支持常见标识符：<code>480P</code>, <code>720P</code>, <code>1080P</code>, <code>2K</code>, <code>4K</code>, <code>6K</code>, <code>8K</code> 等</li>
                    <li>自定义格式：<code>宽度x高度</code>，例如 <code>5120x2880</code></li>
                </ul>
            </li>
            <li>保存并重启软件后生效</li>
        </ol>
    </div>

    <h2>⚠️ 注意事项</h2>
    <div class="note">
        <ul>
            <li>系统要求：Windows 10 及以上版本</li>
            <li>需要安装 <a href="https://aka.ms/vs/17/release/vc_redist.x64.exe" target="_blank">Visual C++ 运行库</a>
                <ul>
                    <li>如果运行时提示缺少 DLL，请安装此运行库</li>
                </ul>
            </li>
            <li>较高的分辨率可能会影响游戏性能，请根据设备性能适当调整</li>
            <li>建议在拍摄前先进行画质对比测试，选择最适合的设置</li>
        </ul>
    </div>

    <h2>🔒 安全性说明</h2>
    <div class="note">
        <p>本程序仅通过 Windows 系统标准的窗口管理 API 发送请求，所有调整都由 Windows 系统自行执行，原理等同于：</p>
        <ul>
            <li>系统分辨率变更时的窗口自适应</li>
            <li>屏幕旋转时的窗口重排</li>
            <li>多显示器下的窗口移动</li>
        </ul>
    </div>

    <h2>💬 问题反馈</h2>
    <div class="download-links">
        <p>常见问题及解决方案：<a href="https://chaniok.github.io/SpinningMomo/zh/advanced/troubleshooting.html" target="_blank">https://chaniok.github.io/SpinningMomo/zh/advanced/troubleshooting.html</a></p>
        <p>如果遇到问题或有建议，欢迎通过以下方式反馈：</p>
        <ul>
            <li>GitHub 仓库：<a href="https://github.com/chaniok/SpinningMomo" target="_blank">https://github.com/chaniok/SpinningMomo</a></li>
            <li>提交 Issue：<a href="https://github.com/chaniok/SpinningMomo/issues" target="_blank">https://github.com/chaniok/SpinningMomo/issues</a></li>
            <li>如果觉得这个工具对你有帮助，欢迎点个 Star ⭐ 支持一下~</li>
        </ul>
    </div>
</body>
</html>
